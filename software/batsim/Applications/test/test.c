#include "test.h"

static const uint16_t imagedata[1024] = {
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x1082,0x39c7,0x31a6,0x18e3,0x1082,0x1082,0x10a2,0x0861,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x1082,0x5aeb,0xbdd7,0x94b3,0x4208,0x2945,0x2945,0x5acb,0x632c,0x0841,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0841,0x39c7,0x5acb,0x9cd3,0x94b2,0x94b2,0x9cd3,0x6b6d,0x3186,0x2945,0x2945,0x39c7,0x4208,0x2124,0x4a49,0x630c,0x3186,0x0020,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x2945,0x52aa,0x630c,0xad55,0x9cd3,0x8c31,0x73ae,0x5aeb,0x31a6,0x31a6,0x31a6,0x31a6,0x3186,0x3186,0x5aeb,0x8c51,0x5acb,0x18c3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x2124,0x4228,0x5aeb,0x9cd3,0x9cd3,0x9492,0x8c71,0x7bcf,0x52aa,0x528a,0x528a,0x4a69,0x4a69,0x4a49,0x632c,0x738e,0x4a49,0x18e3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x2124,0x3186,0x39e7,0x8c51,0x7bef,0x6b6d,0x630c,0x4208,0x0841,0x0020,0x0020,0x0020,0x0020,0x0020,0x39c7,0x52ab,0x31a6,0x18e3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x2124,0x31e6,0x4268,0x8cb1,0x7c4f,0x740d,0x63ac,0x4ae9,0x1962,0x1142,0x1141,0x1121,0x1101,0x1101,0x3a47,0x5b0a,0x31e6,0x18e3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x29e4,0x7e0c,0x96cf,0xbf56,0xbf55,0xb734,0xb733,0xa711,0x8ead,0x86ac,0x868c,0x866c,0x7e4b,0x7e0b,0x8e4e,0x964f,0x6509,0x2163,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x3245,0x874b,0x976c,0xbf94,0xb793,0xb771,0xaf70,0x9f2d,0x76e7,0x76c7,0x76a6,0x6e86,0x6e85,0x6665,0x868a,0x96ad,0x7608,0x29e3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x3245,0x8eea,0x972b,0xbf73,0xb752,0xaf50,0xa72e,0x96eb,0x76a4,0x6e84,0x6e63,0x6e43,0x6e43,0x6e23,0x8669,0x968c,0x7e08,0x29e3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x3a25,0x96ca,0x9eeb,0xc753,0xbf31,0xb730,0xaf0e,0x9ecb,0x8664,0x7e44,0x7e43,0x7e23,0x7e23,0x7603,0x9669,0xa68c,0x8608,0x29e4,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x3a25,0x9e89,0xa6cb,0xcf33,0xc711,0xbef0,0xb6ee,0xaeab,0x8e24,0x8e03,0x8e03,0x8e03,0x85e3,0x85e3,0x9e49,0xae8c,0x95e8,0x31e4,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x3a25,0xa649,0xae8a,0xcf13,0xcef1,0xc6cf,0xbeae,0xb66a,0x9de4,0x95e3,0x95c3,0x95c3,0x95c3,0x95c3,0xae29,0xb66c,0x9de8,0x31c4,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x3a05,0xae09,0xbe4a,0xd6f2,0xced1,0xceaf,0xc68e,0xbe4a,0xa5a3,0xa5a3,0xa5a3,0xa583,0xa583,0x9d83,0xb609,0xbe4c,0xadc8,0x31c4,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x4205,0xbdc8,0xc60a,0xded2,0xd6b1,0xd68f,0xce4d,0xc60a,0xb563,0xad63,0xad63,0xad43,0xad42,0xad43,0xbde9,0xc62c,0xb5a8,0x39c4,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x41e5,0xc5a8,0xcde9,0xdeb2,0xde90,0xd64f,0xd62d,0xcdca,0xbd23,0xbd22,0xbd22,0xbd22,0xbd02,0xbd02,0xc5a8,0xce0c,0xbd68,0x39c4,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x41e5,0xcd68,0xd5a9,0xe692,0xe670,0xde2f,0xde0d,0xd5a9,0xc4e2,0xc4e2,0xc4e2,0xc4e2,0xc4e2,0xc4e2,0xd588,0xd5ec,0xc548,0x39a3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x41e4,0xd527,0xdd69,0xee72,0xe630,0xe60e,0xe5cd,0xdd69,0xd4a2,0xd482,0xd482,0xd482,0xd482,0xd4a2,0xdd48,0xddcc,0xcd28,0x39a3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x41c4,0xdce7,0xe528,0xee52,0xee10,0xedee,0xedac,0xe529,0xdc62,0xdc41,0xdc41,0xdc41,0xdc41,0xdc41,0xe528,0xe58c,0xdce7,0x41a3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x49c4,0xe4a7,0xece8,0xf611,0xf5f0,0xedae,0xed6c,0xece9,0xe3e2,0xe3e1,0xe3e1,0xe3e1,0xe3e1,0xe3e1,0xecc8,0xed4b,0xdca7,0x4183,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x49a4,0xe427,0xec68,0xf5d2,0xf590,0xed4e,0xed0d,0xec69,0xe342,0xe341,0xe341,0xe341,0xe341,0xe341,0xe448,0xecec,0xdc47,0x4183,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x4985,0xe3a8,0xebe9,0xf592,0xed30,0xecef,0xec8d,0xe3e9,0xdaa2,0xda82,0xdaa2,0xd2a2,0xd2a2,0xd2a2,0xdbc8,0xe48c,0xd3c8,0x4163,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x4985,0xe328,0xeb69,0xf532,0xecd1,0xec8f,0xe42d,0xdb6a,0xd203,0xd1e2,0xc9e2,0xc9e2,0xc202,0xc202,0xcb48,0xd42c,0xc348,0x3943,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x4965,0xe2a9,0xeaca,0xecf2,0xec71,0xe40f,0xe3ad,0xdaea,0xc943,0xc142,0xc142,0xb942,0xb942,0xb962,0xc2c8,0xcbac,0xbac8,0x3923,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x4124,0xdaaa,0xe34d,0xed34,0xecf3,0xecb2,0xec71,0xe3ce,0xd289,0xd268,0xca68,0xca68,0xc268,0xc267,0xcb6c,0xcbee,0xaac9,0x3103,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x2924,0x6a8a,0x938e,0xcdb6,0xc554,0xbcd3,0xac71,0xa3ae,0x8a8a,0x8289,0x8289,0x8289,0x8289,0x7a89,0x938d,0xa471,0x6acb,0x18c3,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x10a2,0x4249,0x73ae,0xce79,0xbdd7,0xa514,0x8430,0x5acb,0x2124,0x2124,0x2124,0x2925,0x2925,0x2965,0x632c,0x8430,0x4208,0x0861,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0020,0x10a2,0x2124,0x2945,0x2945,0x2124,0x18e3,0x1082,0x1061,0x1061,0x0861,0x0861,0x0861,0x1082,0x0861,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,0x0000,
};

static Image_t icon = { .width = 32, .height = 32, .data = imagedata };

static xTaskHandle hTask;

void test_Init() {
	/* register app at desktop module */
	AppInfo_t app;
	strcpy(app.name, "TestApp");
	app.start = test_Start;
	app.icon = icon;
	desktop_AddApp(app);
}

static void stop() {
	xTaskNotify(hTask, SIGNAL_TERMINATE, eSetValueWithOverwrite);
}

void test_Start(){
	xTaskCreate(test, "GUI", 300, NULL, 3, NULL);
}

void test(void) {
	hTask = xTaskGetCurrentTaskHandle();

	/* create GUI */
	container_t *c = container_new(COORDS(280, 240));
	button_t *b = button_new("Stop", Font_Big, 0, stop);
	uint8_t var = 0;
	checkbox_t *check = checkbox_new(&var, NULL);
	int32_t val, min = -30000000, max = 30000000;
	entry_t *e = entry_new(&val, &max, &min, Font_Big, 9, Unit_Current);
	container_attach(c, b, COORDS(20, 20));
	container_attach(c, e, COORDS(20, 60));
	container_attach(c, check, COORDS(20, 80));
	c->base.position.x = 40;

	desktop_AppStarted(test_Start, c);
	uint32_t signal;

	while(1) {
		if (xTaskNotifyWait(ULONG_MAX, ULONG_MAX, &signal, 10)) {
			/* received a notication */
			switch (signal) {
			case SIGNAL_TERMINATE:
				desktop_AppStopped(test_Start);
				widget_delete(c);
				vTaskDelete(NULL);
				return;
				break;
			}
		}
	}
}
